# Building From BentoScript

&nbsp;

BentoScript is the language that Bento uses to describe UI layouts (as well as UI behaviour). BentoScript is a modified version of [Catspeak]() by [Katsaii](), a language specifically designed to work smoothly with GameMaker. BentoScript is compiled at runtime by the library and therefore can, and does, support live updating of UI layouts.

&nbsp;

### BentoScript Overview

BentoScript isn't a million miles away from GML and if you're comfortable with GML then you'll get to grips with it quickly:

- BentoScript is sandboxed. To access anything in your project (functions, objects, sprites, sounds, etc.) you'll need to explicitly whitelist it.

- Variables are weakly typed. Variables can be numbers, strings, arrays, structs, or functions. Struct/array literals are supported.

- There are no methods, only simple functions. Every function is called in the current scope.

- There are only `while` loops. The other types of loops in GML (`for` `repeat` `do...until` `with`) aren't supported.

- `switch...case` statements aren't supported either.

- Functions are defined using the abbreviation `fn` (instead of GML's `function`).

- Function definitions come up a lot when defining callbacks and most callbacks don't receive arguments. If a function has no arguments then instead of typing `fn()` you can shorten it further to `fn`.

- A new command `build` has been added to assist with creating a UI tree (`build` replaces Catspeak's native `use`, though it returns the result of the close function).

- BentoScript doesn't support the unary operators `++` or `--` (use `+= 1` or `-= 1` respectively).

&nbsp;

## Executing BentoScript

Code stored in BentoScript files can be executed using a few different GML functions:

- `BentoFileExecuteLayerTop()`
- `BentoFileExecuteLayerOver()`
- `BentoFileExecuteLayerPriority()`

Mostly you'll be using the convenience function `BentoFileExecuteLayerTop()` but you can execute BentoScript files using any of the above. Each of these functions creates a new layer and then executes the BentoScript file, placing whatever is generated by that file on the layer.

!> `BentoFileExecute()` exists as well. In general, this function should be avoided unless you're confident you know what you're doing.

Another useful feature is replacing a UI element with the result of executing a file. You can do this two ways: 

1. BentoScript function `BoxReplace()`

2. Method `.ReplaceFromFile()`

Replacing UI elements seems a little strange on the face of it but it is a powerful tool that can be used to create pages of content inside your UI. Instead of regenerating an entire UI layer, you can designate a UI element as a replaceable frame and then replace only that frame. This feature, in combination with some buttons positions as tabs, allows for some very complex behaviour.

Finally, you can also execute a BentoScript string using `BentoStringExecute()`. When you call this function, Bento will parse the string and store the compiled program in an internal cache. Subsequent executions of the string will skip the parsing and compiling stage and will skip straight to execution. `BentoStringExecute()` isn't inherently slower than executing BentoScript from a file but overuse of this functionality may lead to uncomfortable hitching when navigating menus.

&nbsp;

## The `build` Command

Building UI with BentoScript is a case of calling the `build` command and targeting a UI class. Anything inside the subsequent curly brackets will be executed in the scope of the new UI element, a little bit like a `with()` statement in GML.

```
build BentoRectangle {
	ltrb = [20, 20, parent.width-20, parent.height-20]
}
```

`build` commands can be nested inside each other. When you execute a build command in the scope of a UI element, the new UI element is added to the old one a child.

```
build BentoRectangle {
	ltrb = [20, 20, parent.width-20, parent.height-20]

	build BentoRectangle {
		ltrb = [20, 20, parent.width/2 - 10, parent.height-20]
	}

	build BentoRectangle {
		ltrb = [parent.width/2 + 10, 20, parent.width - 20, parent.height-20]
	}
}
```

&nbsp;

## Variables

&nbsp;

## Callbacks

&nbsp;

## Methods